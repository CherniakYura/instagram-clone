{"version":3,"sources":["lib/firebase.js","constants/routes.js","context/firebase.js","services/firebase.js","context/user.js","components/searchDropdown.js","components/NavBar.js","helpers/protected.route.js","App.js","hooks/use-auth-listener.js","index.js"],"names":["firebase","Firebase","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","db","getFirestore","auth","getAuth","DASHBOARD","LOGIN","SIGN_UP","PROFILE","NOT_FOUND","FirebaseContext","createContext","doesUsernameExist","username","a","q","query","collection","where","getDocs","querySnapshot","docs","length","getUserByUsername","user","map","item","data","docId","id","getUserByUserId","userId","getSuggestedProfiles","following","limit","filter","profile","includes","updateLoggedUserFollowing","loggedUserDocId","profileId","followed","loggedUserRef","doc","updateDoc","arrayRemove","arrayUnion","updateFollowedUserFollowers","spDocId","FollowedUserRef","followers","getPhotos","userFollowedPhotos","photo","Promise","all","userLikedPhoto","likes","photosWithUserDetails","getUserPhotosByUsername","photos","sort","b","dateCreated","addComment","comment","displayName","photoRef","comments","isUserFollowingProfile","profileUserId","toggleFollow","isFollowingProfile","activeUserDocId","profileDocId","activeUserId","getAllProfiles","UserContext","SearchDropdown","users","setActiveSearchDropdown","className","onOutsideClick","onClick","to","width","height","viewBox","fill","d","NavBar","inHome","inProfile","useState","searchValue","setSearchValue","useContext","activeUsername","activeSearchDropdown","allUsers","setAllUsers","fuse","Fuse","keys","useEffect","then","result","console","log","getAllUsers","signInWithEmailAndPassword","createUserWithEmailAndPassword","ROUTES","alt","src","onChange","target","value","onFocus","placeholder","search","color","role","signOut","xmlns","class","stroke","ProtectedRoute","children","Login","lazy","SignUp","NotFound","Dashboard","Profile","App","setInHome","setInProfile","setUsername","JSON","parse","localStorage","getItem","setUser","listener","onAuthStateChanged","authUser","setItem","stringify","removeItem","useAuthListener","uid","myuser","getUsername","basename","Provider","fallback","exact","path","element","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1863821a.chunk.js","sourcesContent":["import * as Firebase from \"firebase/app\";\r\nimport {\r\n    getAuth,\r\n    signInWithEmailAndPassword,\r\n    createUserWithEmailAndPassword,\r\n} from \"firebase/auth\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\n\r\n\r\n// Your web app's Firebase configuration\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyCS17XJapSFDZzaPAVKPWM_uZqZrfD8GmA\",\r\n    authDomain: \"instagram-clone-4a846.firebaseapp.com\",\r\n    projectId: \"instagram-clone-4a846\",\r\n    storageBucket: \"instagram-clone-4a846.appspot.com\",\r\n    messagingSenderId: \"233007670425\",\r\n    appId: \"1:233007670425:web:7a9880b861c364b3e94408\",\r\n};\r\n\r\nconst firebase =  Firebase.initializeApp(firebaseConfig);\r\n\r\n//console.log(firebase);\r\n\r\nconst  db  = getFirestore();\r\nconst auth = getAuth();\r\n//seedDatabase(FieldValue);\r\n\r\nexport {\r\n    firebase,\r\n    db,\r\n    auth,\r\n    signInWithEmailAndPassword,\r\n    createUserWithEmailAndPassword,\r\n};","export const DASHBOARD = \"/\";\r\nexport const LOGIN = \"/login\";\r\nexport const SIGN_UP = \"/signup\";\r\nexport const PROFILE = \"/p/:username\";\r\nexport const NOT_FOUND = \"/not-found\";\r\n","import { createContext } from \"react\";\r\n\r\nconst FirebaseContext = createContext(null);\r\nexport default FirebaseContext;\r\n","import {\r\n    firebase,\r\n    db,\r\n    auth,\r\n    signInWithEmailAndPassword,\r\n} from \"../lib/firebase\";\r\nimport {\r\n    collection,\r\n    query,\r\n    where,\r\n    getDocs,\r\n    limit,\r\n    updateDoc,\r\n    arrayUnion,\r\n    arrayRemove,\r\n    doc,\r\n} from \"firebase/firestore\";\r\n\r\nexport async function doesUsernameExist(username) {\r\n    const q = query(collection(db, \"users\"), where(\"username\", \"==\", username));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    return querySnapshot.docs.length;\r\n}\r\n\r\nexport async function getUserByUsername(username) {\r\n    const q = query(collection(db, \"users\"), where(\"username\", \"==\", username));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    const user = querySnapshot.docs.map((item) => ({\r\n        ...item.data(),\r\n        docId: item.id,\r\n    }));\r\n\r\n    return user[0];\r\n}\r\n\r\nexport async function getUserByUserId(userId) {\r\n    const q = query(collection(db, \"users\"), where(\"userId\", \"==\", userId));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    const user = querySnapshot.docs.map((item) => ({\r\n        ...item.data(),\r\n        docId: item.id,\r\n    }));\r\n\r\n    return user[0];\r\n}\r\n\r\nexport async function getSuggestedProfiles(userId, following) {\r\n    // const querySnapshot = await getDocs(collection(db, \"users\", limit(5)));\r\n    const q = query(collection(db, \"users\"), limit(5));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    // console.log(querySnapshot.docs[4].data());\r\n    return querySnapshot.docs\r\n        .map((user) => ({ ...user.data(), docId: user.id }))\r\n        .filter(\r\n            (profile) =>\r\n                profile.userId != userId && !following.includes(profile.userId)\r\n        );\r\n}\r\n\r\nexport async function updateLoggedUserFollowing(\r\n    loggedUserDocId,\r\n    profileId,\r\n    followed\r\n) {\r\n    const loggedUserRef = doc(db, \"users\", loggedUserDocId);\r\n\r\n    followed\r\n        ? await updateDoc(loggedUserRef, {\r\n              following: arrayRemove(profileId),\r\n          })\r\n        : await updateDoc(loggedUserRef, {\r\n              following: arrayUnion(profileId),\r\n          });\r\n\r\n    return;\r\n}\r\n\r\nexport async function updateFollowedUserFollowers(spDocId, userId, followed) {\r\n    const FollowedUserRef = doc(db, \"users\", spDocId);\r\n\r\n    followed\r\n        ? await updateDoc(FollowedUserRef, {\r\n              followers: arrayRemove(userId),\r\n          })\r\n        : await updateDoc(FollowedUserRef, {\r\n              followers: arrayUnion(userId),\r\n          });\r\n\r\n    return;\r\n}\r\n\r\nexport async function getPhotos(userId, following) {\r\n    const q = query(collection(db, \"photos\"), where(\"userId\", \"in\", following));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    const userFollowedPhotos = querySnapshot.docs.map((photo) => ({\r\n        ...photo.data(),\r\n        docId: photo.id,\r\n    }));\r\n\r\n    const photosWithUserDetails = await Promise.all(\r\n        userFollowedPhotos.map(async (photo) => {\r\n            let userLikedPhoto = false;\r\n            if (photo.likes.includes(userId)) {\r\n                userLikedPhoto = true;\r\n            }\r\n\r\n            const { username } = await getUserByUserId(photo.userId);\r\n\r\n            return { username, ...photo, userLikedPhoto };\r\n        })\r\n    );\r\n\r\n    return photosWithUserDetails;\r\n}\r\n\r\nexport async function getUserPhotosByUsername(username) {\r\n    const { userId } = await getUserByUsername(username);\r\n    const q = query(collection(db, \"photos\"), where(\"userId\", \"==\", userId));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    const photos = querySnapshot.docs\r\n        .map((item) => ({\r\n            ...item.data(),\r\n            docId: item.id,\r\n        }))\r\n        .sort((a, b) => b.dateCreated - a.dateCreated);\r\n\r\n    return photos;\r\n}\r\n\r\nexport async function addComment(docId, comment, displayName) {\r\n    const photoRef = doc(db, \"photos\", docId);\r\n\r\n    await updateDoc(photoRef, {\r\n        comments: arrayUnion({ displayName, comment }),\r\n    });\r\n\r\n    return;\r\n}\r\n\r\nexport async function isUserFollowingProfile(username, profileUserId) {\r\n    const q = query(\r\n        collection(db, \"users\"),\r\n        where(\"username\", \"==\", username),\r\n        where(\"following\", \"array-contains\", profileUserId)\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    //console.log(!!querySnapshot.docs[0]);\r\n    return !!querySnapshot.docs[0];\r\n}\r\n\r\nexport async function toggleFollow(\r\n    isFollowingProfile,\r\n    activeUserDocId,\r\n    profileDocId,\r\n    profileUserId,\r\n    activeUserId\r\n) {\r\n    await updateLoggedUserFollowing(\r\n        activeUserDocId,\r\n        profileUserId,\r\n        isFollowingProfile\r\n    );\r\n    await updateFollowedUserFollowers(\r\n        profileDocId,\r\n        activeUserId,\r\n        isFollowingProfile\r\n    );\r\n        \r\n    return;\r\n}\r\n\r\n\r\nexport async function getAllProfiles(username) {\r\n    // const querySnapshot = await getDocs(collection(db, \"users\", limit(5)));\r\n    const q = query(collection(db, \"users\"), limit(6));\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    // console.log(querySnapshot.docs[4].data());\r\n    return querySnapshot.docs\r\n        .map((user) => ({ ...user.data(), docId: user.id }))\r\n        .filter(\r\n            (profile) =>\r\n                profile.username != username\r\n        );\r\n}","import { createContext } from \"react\";\r\n\r\nconst UserContext = createContext(null);\r\nexport default UserContext;","import { Link } from \"react-router-dom\";\r\nimport OutsideClickHandler from \"react-outside-click-handler\";\r\n\r\nexport default function SearchDropdown({ users ,setActiveSearchDropdown}) {\r\n    return (\r\n        <div className=\"search-dropdown-container\">\r\n            <OutsideClickHandler\r\n                onOutsideClick={() => {\r\n                    setActiveSearchDropdown(false);\r\n                }}\r\n            >\r\n                {users.length > 0 ? (\r\n                    users.map((user) => (\r\n                        <div\r\n                            className=\"search-user-container\"\r\n                            onClick={() => setActiveSearchDropdown(false)}\r\n                        >\r\n                            <Link\r\n                                to={`/p/${user.item.username}`}\r\n                                className=\"profile-link\"\r\n                            >\r\n                                <svg\r\n                                    className=\"search-profile-icon\"\r\n                                    width=\"24\"\r\n                                    height=\"24\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                    fill=\"none\"\r\n                                >\r\n                                    <path\r\n                                        fill-rule=\"evenodd\"\r\n                                        clip-rule=\"evenodd\"\r\n                                        d=\"M16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5C14.2091 5 16 6.79086 16 9ZM14 9C14 10.1046 13.1046 11 12 11C10.8954 11 10 10.1046 10 9C10 7.89543 10.8954 7 12 7C13.1046 7 14 7.89543 14 9Z\"\r\n                                        fill=\"currentColor\"\r\n                                    />\r\n                                    <path\r\n                                        fill-rule=\"evenodd\"\r\n                                        clip-rule=\"evenodd\"\r\n                                        d=\"M12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1ZM3 12C3 14.0902 3.71255 16.014 4.90798 17.5417C6.55245 15.3889 9.14627 14 12.0645 14C14.9448 14 17.5092 15.3531 19.1565 17.4583C20.313 15.9443 21 14.0524 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12ZM12 21C9.84977 21 7.87565 20.2459 6.32767 18.9878C7.59352 17.1812 9.69106 16 12.0645 16C14.4084 16 16.4833 17.1521 17.7538 18.9209C16.1939 20.2191 14.1881 21 12 21Z\"\r\n                                        fill=\"currentColor\"\r\n                                    />\r\n                                </svg>\r\n                                {user.item.username}\r\n                            </Link>\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <div className=\"not-found\">No matches</div>\r\n                )}\r\n               \r\n            </OutsideClickHandler>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useEffect, useState, useContext } from \"react\";\r\nimport FirebaseContext from \"../context/firebase\";\r\nimport UserContext from \"../context/user\";\r\nimport \"../styles/NavBar.css\";\r\nimport * as ROUTES from \"../constants/routes\";\r\nimport { Link, Router, useNavigate } from \"react-router-dom\";\r\nimport { signOut } from \"firebase/auth\";\r\nimport Fuse from \"fuse.js\";\r\nimport { getAllProfiles } from \"../services/firebase\";\r\nimport SearchDropdown from \"./searchDropdown\";\r\n\r\nexport default function NavBar({ inHome, inProfile }) {\r\n    const [searchValue, setSearchValue] = useState(\"\");\r\n\r\n    const { user, activeUsername } = useContext(UserContext);\r\n    const [activeSearchDropdown, setActiveSearchDropdown] = useState(false);\r\n    const [allUsers, setAllUsers] = useState([]);\r\n\r\n    const fuse = new Fuse(allUsers, {\r\n        keys: [\"username\", \"fullName\"],\r\n    });\r\n\r\n    useEffect(() => {\r\n        async function getAllUsers() {\r\n             await getAllProfiles(activeUsername).then((result)=>setAllUsers(result));\r\n\r\n           \r\n            console.log(\"all\",allUsers);\r\n           \r\n        }\r\n        if (activeUsername) {\r\n            getAllUsers();\r\n        }\r\n    }, [activeUsername]);\r\n\r\n    const {\r\n        firebase,\r\n        db,\r\n        auth,\r\n        signInWithEmailAndPassword,\r\n        createUserWithEmailAndPassword,\r\n    } = useContext(FirebaseContext);\r\n\r\n    \r\n    return (\r\n        <div className=\"navbar-container\">\r\n            <div className=\"nav-content-container\">\r\n                <Link to={ROUTES.DASHBOARD}>\r\n                    <img\r\n                        alt=\"instagram logo\"\r\n                        className=\"logo\"\r\n                        src=\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\"\r\n                    />\r\n                </Link>\r\n        \r\n                <div className=\"search-container\">\r\n                    <input\r\n                        onChange={({ target }) => {\r\n                            setSearchValue(target.value);\r\n                        }}\r\n                        value={searchValue}\r\n                        onFocus={() => setActiveSearchDropdown(true)}\r\n                        className={`nav-search ${\r\n                            searchValue ? null : \"search-img\"\r\n                        }`}\r\n                        placeholder={\r\n                            searchValue ? `   ${searchValue}` : \"   Search\"\r\n                        }\r\n                    />\r\n                    {activeSearchDropdown ? (\r\n                        <>\r\n                            <SearchDropdown\r\n                                users={fuse.search(searchValue)}\r\n                                setActiveSearchDropdown={\r\n                                    setActiveSearchDropdown\r\n                                }\r\n                            />{\" \"}\r\n                            <div className=\"arrow\"></div>\r\n                        </>\r\n                    ) : null}\r\n                </div>\r\n\r\n                <div className=\"nav-icons\">\r\n                    <Link to={ROUTES.DASHBOARD}>\r\n                        {inHome ? (\r\n                            <svg\r\n                                aria-label=\"Главная страница\"\r\n                                className=\"icon home\"\r\n                                color=\"#262626\"\r\n                                fill=\"#262626\"\r\n                                height=\"22\"\r\n                                role=\"img\"\r\n                                viewBox=\"0 0 48 48\"\r\n                                width=\"22\"\r\n                            >\r\n                                <path d=\"M45.5 48H30.1c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2.1-4.6-4.6-4.6s-4.6 2.1-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.6-.6 2.1 0l21.5 21.5c.3.3.4.7.4 1.1v23.5c.1.8-.6 1.5-1.4 1.5z\"></path>\r\n                            </svg>\r\n                        ) : (\r\n                            <svg\r\n                                aria-label=\"home \"\r\n                                className=\"home icon\"\r\n                                color=\"#262626\"\r\n                                fill=\"#262626\"\r\n                                height=\"22\"\r\n                                role=\"img\"\r\n                                viewBox=\"0 0 48 48\"\r\n                                width=\"22\"\r\n                            >\r\n                                <path d=\"M45.3 48H30c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2-4.6-4.6-4.6s-4.6 2-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.5-.6 2.1 0l21.5 21.5c.4.4.6 1.1.3 1.6 0 .1-.1.1-.1.2v22.8c.1.8-.6 1.5-1.4 1.5zm-13.8-3h12.3V23.4L24 3.6l-20 20V45h12.3V34.2c0-4.3 3.3-7.6 7.6-7.6s7.6 3.3 7.6 7.6V45z\"></path>\r\n                            </svg>\r\n                        )}\r\n                    </Link>\r\n\r\n                    <svg\r\n                        aria-label=\"Новая публикация\"\r\n                        className=\"icon\"\r\n                        color=\"#262626\"\r\n                        fill=\"#262626\"\r\n                        height=\"22\"\r\n                        role=\"img\"\r\n                        viewBox=\"0 0 48 48\"\r\n                        width=\"22\"\r\n                    >\r\n                        <path d=\"M31.8 48H16.2c-6.6 0-9.6-1.6-12.1-4C1.6 41.4 0 38.4 0 31.8V16.2C0 9.6 1.6 6.6 4 4.1 6.6 1.6 9.6 0 16.2 0h15.6c6.6 0 9.6 1.6 12.1 4C46.4 6.6 48 9.6 48 16.2v15.6c0 6.6-1.6 9.6-4 12.1-2.6 2.5-5.6 4.1-12.2 4.1zM16.2 3C10 3 7.8 4.6 6.1 6.2 4.6 7.8 3 10 3 16.2v15.6c0 6.2 1.6 8.4 3.2 10.1 1.6 1.6 3.8 3.1 10 3.1h15.6c6.2 0 8.4-1.6 10.1-3.2 1.6-1.6 3.1-3.8 3.1-10V16.2c0-6.2-1.6-8.4-3.2-10.1C40.2 4.6 38 3 31.8 3H16.2z\"></path>\r\n                        <path d=\"M36.3 25.5H11.7c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h24.6c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5z\"></path>\r\n                        <path d=\"M24 37.8c-.8 0-1.5-.7-1.5-1.5V11.7c0-.8.7-1.5 1.5-1.5s1.5.7 1.51.5v24.6c0 .8-.7 1.5-1.5 1.5z\"></path>\r\n                    </svg>\r\n                    {/* <svg\r\n                        aria-label=\"notify\"\r\n                        className=\"reminder icon\"\r\n                        color=\"#262626\"\r\n                        fill=\"#262626\"\r\n                        height=\"22\"\r\n                        role=\"img\"\r\n                        viewBox=\"0 0 48 48\"\r\n                        width=\"22\"\r\n                    >\r\n                        <path d=\"M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z\"></path>\r\n                    </svg> */}\r\n\r\n                    {user ? (\r\n                        <>\r\n                            <Link to={`/p/${activeUsername}`}>\r\n                                <svg\r\n                                    className=\"icon profile\"\r\n                                    width=\"24\"\r\n                                    height=\"24\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                    fill=\"none\"\r\n                                >\r\n                                    <path\r\n                                        fill-rule=\"evenodd\"\r\n                                        clip-rule=\"evenodd\"\r\n                                        d=\"M16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5C14.2091 5 16 6.79086 16 9ZM14 9C14 10.1046 13.1046 11 12 11C10.8954 11 10 10.1046 10 9C10 7.89543 10.8954 7 12 7C13.1046 7 14 7.89543 14 9Z\"\r\n                                        fill=\"currentColor\"\r\n                                    />\r\n                                    <path\r\n                                        fill-rule=\"evenodd\"\r\n                                        clip-rule=\"evenodd\"\r\n                                        d=\"M12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1ZM3 12C3 14.0902 3.71255 16.014 4.90798 17.5417C6.55245 15.3889 9.14627 14 12.0645 14C14.9448 14 17.5092 15.3531 19.1565 17.4583C20.313 15.9443 21 14.0524 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12ZM12 21C9.84977 21 7.87565 20.2459 6.32767 18.9878C7.59352 17.1812 9.69106 16 12.0645 16C14.4084 16 16.4833 17.1521 17.7538 18.9209C16.1939 20.2191 14.1881 21 12 21Z\"\r\n                                        fill=\"currentColor\"\r\n                                    />\r\n                                </svg>\r\n                            </Link>\r\n\r\n                            <Link to={ROUTES.LOGIN}>\r\n                                <svg\r\n                                    onClick={() => {\r\n                                        signOut(auth);\r\n                                    }}\r\n                                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                                    class=\"icon \"\r\n                                    fill=\"none\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                    stroke=\"currentColor\"\r\n                                >\r\n                                    <path\r\n                                        stroke-linecap=\"round\"\r\n                                        stroke-linejoin=\"round\"\r\n                                        stroke-width=\"2\"\r\n                                        d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\"\r\n                                    />\r\n                                </svg>\r\n                            </Link>\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <Link to={ROUTES.LOGIN}>\r\n                                <svg\r\n                                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                                    class=\"icon login\"\r\n                                    fill=\"none\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                    stroke=\"currentColor\"\r\n                                >\r\n                                    <path\r\n                                        stroke-linecap=\"round\"\r\n                                        stroke-linejoin=\"round\"\r\n                                        stroke-width=\"2\"\r\n                                        d=\"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1\"\r\n                                    />\r\n                                </svg>\r\n                            </Link>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { Route, Navigate, Outlet } from \"react-router-dom\";\r\nimport * as ROUTES from \"../constants/routes\";\r\n\r\nexport default function ProtectedRoute({ user, children, ...rest }) {\r\n   // console.log(user);\r\n    return user ? <Outlet /> : <Navigate to={ROUTES.LOGIN} />;\r\n    return (\r\n        <Route\r\n            {...rest}\r\n            render={({ location }) => {\r\n                if (user) {\r\n                    return children;\r\n                }\r\n                if (!user) {\r\n                    return <Navigate to={ROUTES.LOGIN} />;\r\n                }\r\n\r\n                return null;\r\n            }}\r\n        />\r\n    );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\nimport \"./styles/App.css\";\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\nimport NavBar from \"./components/NavBar\";\nimport { lazy, Suspense } from \"react\";\nimport * as ROUTES from \"./constants/routes\";\nimport useAuthListener from \"./hooks/use-auth-listener\";\nimport UserContext from \"./context/user\";\nimport { getUserByUserId } from \"./services/firebase\";\n\n\nimport ProtectedRoute from \"./helpers/protected.route\";\n\nconst Login = lazy(() => import(\"./pages/login\"));\nconst SignUp = lazy(() => import(\"./pages/signup\"));\nconst NotFound = lazy(() => import(\"./pages/notfound\"));\nconst Dashboard = lazy(() => import(\"./pages/dashboard\"));\nconst Profile = lazy(() => import(\"./pages/profile\"));\n\nfunction App() {\n    const [inHome, setInHome] = useState(false);\n    const [inProfile, setInProfile] = useState(false);\n    const [username, setUsername] = useState(\"\");\n    const { user } = useAuthListener();\n\n    async function getUsername() {\n        const myuser = await getUserByUserId(user.uid);\n        return myuser.username;\n    }\n\n    if (user) {\n        getUsername().then((result) => setUsername(result));\n    }\n\n    return (\n        <Router basename=\"/instagram-clone\">\n            <UserContext.Provider value={{ user, activeUsername: username }}>\n                <Suspense fallback={<p>Loading...</p>}>\n                    <div className=\"pagesContainer\">\n                        <Routes>\n                            <Route\n                                exact\n                                path={ROUTES.LOGIN}\n                                element={<Login />}\n                            />\n\n                            <Route\n                                exact\n                                path={ROUTES.SIGN_UP}\n                                element={<SignUp />}\n                            />\n\n                            <Route\n                                exact\n                                path={ROUTES.DASHBOARD}\n                                element={<ProtectedRoute user={user} />}\n                            >\n                                <Route\n                                    exact\n                                    path={ROUTES.DASHBOARD}\n                                    element={\n                                        <Dashboard\n                                            inHome={inHome}\n                                            setInHome={setInHome}\n                                            setInProfile={setInProfile}\n                                        />\n                                    }\n                                />\n\n                                <Route\n                                    exact\n                                    path={ROUTES.PROFILE}\n                                    element={\n                                        <Profile\n                                            inProfile={inProfile}\n                                            setInHome={setInHome}\n                                            setInProfile={setInProfile}\n                                        />\n                                    }\n                                />\n                            </Route>\n\n                            <Route path=\":a\" element={<NotFound />} />\n                        </Routes>\n                    </div>\n                </Suspense>\n            </UserContext.Provider>\n        </Router>\n    );\n}\n\nexport default App;\n","import { useEffect, useState, useContext } from \"react\";\r\nimport FirebaseContext from \"../context/firebase\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\n\r\nexport default function useAuthListener() {\r\n    const [user, setUser] = useState(\r\n        JSON.parse(localStorage.getItem(\"authUser\"))\r\n    );\r\n    const {\r\n       \r\n        auth,\r\n        \r\n    } = useContext(FirebaseContext);\r\n\r\n\r\n    useEffect(() => {\r\n        \r\n       const listener = onAuthStateChanged(auth, (authUser) => {\r\n\r\n            if (authUser) {\r\n                localStorage.setItem('authUser',JSON.stringify(authUser));\r\n                setUser(authUser);\r\n            } else {\r\n                localStorage.removeItem('authUser');\r\n                setUser(null);\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            listener();\r\n        }\r\n    }, [auth])\r\n    return { user };\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n//import './index.css';\nimport App from \"./App\";\nimport FirebaseContext from \"./context/firebase\";\nimport {\n    firebase,\n    db,\n    auth,\n    signInWithEmailAndPassword,\n    createUserWithEmailAndPassword,\n} from \"./lib/firebase\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <FirebaseContext.Provider\n            value={{\n                firebase,\n                db,\n                auth,\n                signInWithEmailAndPassword,\n                createUserWithEmailAndPassword,\n            }}\n        >\n            <App />\n        </FirebaseContext.Provider>\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}